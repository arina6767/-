import asyncio
import random
from aiogram import Bot, Dispatcher, types, Router
from aiogram.filters import Command
from aiogram.filters.text import Text
from aiogram.types import ReplyKeyboardMarkup

# –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π)
TOKEN = "8564961413:AAFNCBFsA-iIoUx-V1E54zX6MUzoKgmeenA"

bot = Bot(token=TOKEN)
dp = Dispatcher()
router = Router()

user_scores = {}
user_state = {}

# –î–∞–Ω–Ω—ã–µ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º, —Å—Ñ–µ—Ä–∞–º –∏ –Ω–∞–ª–æ–≥–∞–º
tax_data = {
    "–ò—Ç–∞–ª–∏—è": {
        "–¢—É—Ä–∏–∑–º": {"–ù–∞–ª–æ–≥ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–ª–∞–≥–∞ –ò—Ç–∞–ª–∏–∏ –≤ –¥–µ–∫–æ—Ä–µ": 0, "–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –∑–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–µ": 2, "–°–±–æ—Ä –∑–∞ –≤—Ö–æ–¥ –≤ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ä–∞–π–æ–Ω—ã": 5, "–ù–∞–ª–æ–≥ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞": 8},
        "–≠–∫–æ–ª–æ–≥–∏—è": {"–ù–∞–ª–æ–≥ –Ω–∞ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å—Ç–∞–∫–∞–Ω—á–∏–∫–∏": 0, "–°–±–æ—Ä –∑–∞ –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏": 2, "–°–±–æ—Ä –∑–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫—É –æ—Ç—Ö–æ–¥–æ–≤": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –≤—ä–µ–∑–¥ –∞–≤—Ç–æ –≤ —Ü–µ–Ω—Ç—Ä –≥–æ—Ä–æ–¥–∞": 8},
        "–ú–µ–¥–∏—Ü–∏–Ω–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É –≤–∏—Ç–∞–º–∏–Ω–æ–≤ —Ç—É—Ä–∏—Å—Ç–∞–º–∏": 0, "–°–±–æ—Ä –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–µ—Å—Ç–Ω—ã—Ö –∫–ª–∏–Ω–∏–∫": 2, "–°–±–æ—Ä –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π": 5, "–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –º–µ–¥—Å–±–æ—Ä –¥–ª—è —Ç—É—Ä–∏—Å—Ç–æ–≤": 8},
        "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ —É–ª–∏—á–Ω—ã—Ö –º—É–∑—ã–∫–∞–Ω—Ç–æ–≤": 0, "–°–±–æ—Ä –∑–∞ —Ç–æ—Ä–≥–æ–≤–ª—é –≤ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö": 2, "–ù–∞–ª–æ–≥ –Ω–∞ –±–∏–∑–Ω–µ—Å –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤": 8}
    },
    "–Ø–ø–æ–Ω–∏—è": {
        "–¢—É—Ä–∏–∑–º": {"–ù–∞–ª–æ–≥ –Ω–∞ —Ñ–æ—Ç–æ –≤ –º–µ—Ç—Ä–æ": 0, "–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –≤ –æ—Ç–µ–ª—è—Ö": 2, "–°–±–æ—Ä –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ö—Ä–∞–º–æ–≤": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–æ–Ω": 8},
        "–≠–∫–æ–ª–æ–≥–∏—è": {"–ù–∞–ª–æ–≥ –Ω–∞ –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã": 0, "–°–±–æ—Ä –∑–∞ —É–ø–∞–∫–æ–≤–∫—É": 2, "–°–±–æ—Ä –∑–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫—É —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏": 8},
        "–ú–µ–¥–∏—Ü–∏–Ω–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ —Å–ª–∞–¥–æ—Å—Ç–∏": 0, "–ù–∞–ª–æ–≥ –Ω–∞ —Å–ª–∞–¥–∫–∏–µ –Ω–∞–ø–∏—Ç–∫–∏": 2, "–°–±–æ—Ä –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –≤—Ä–µ–¥–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã": 8},
        "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ –ø–æ–∑–¥–Ω–∏–µ –ø—Ä–æ–≥—É–ª–∫–∏": 0, "–°–±–æ—Ä –∑–∞ —à—É–º –Ω–æ—á—å—é": 2, "–°–±–æ—Ä —Å –∫–æ–º–ø–∞–Ω–∏–π –∑–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏": 5, "–ù–∞–ª–æ–≥ –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —Ç—Ä—É–¥–∞ –∏ –æ—Ç–¥—ã—Ö–∞": 8}
    },
    "–°–®–ê": {
        "–¢—É—Ä–∏–∑–º": {"–ù–∞–ª–æ–≥ –Ω–∞ —Å–µ–ª—Ñ–∏ –≤ –ø–∞—Ä–∫–µ": 0, "–°–±–æ—Ä –∑–∞ –ø–∞—Ä–∫–æ–≤–∫—É —É –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π": 2, "–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –≤ –æ—Ç–µ–ª—è—Ö": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∫–æ–≤": 8},
        "–≠–∫–æ–ª–æ–≥–∏—è": {"–ù–∞–ª–æ–≥ –Ω–∞ –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ —Ç—Ä—É–±–æ—á–∫–∏": 0, "–°–±–æ—Ä –∑–∞ –≤—ã–≤–æ–∑ –º—É—Å–æ—Ä–∞": 2, "–ù–∞–ª–æ–≥ –Ω–∞ –≤—ã–±—Ä–æ—Å—ã –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π": 5, "–£–≥–ª–µ—Ä–æ–¥–Ω—ã–π –Ω–∞–ª–æ–≥": 8},
        "–ú–µ–¥–∏—Ü–∏–Ω–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ —Ñ–∞—Å—Ç—Ñ—É–¥": 0, "–ù–∞–ª–æ–≥ –Ω–∞ —Å–ª–∞–¥–∫–∏–µ –Ω–∞–ø–∏—Ç–∫–∏": 2, "–°–±–æ—Ä –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –æ–∂–∏—Ä–µ–Ω–∏—è": 5, "–ù–∞–ª–æ–≥ –Ω–∞ —É–ª—å—Ç—Ä–∞–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—É—é –ø–∏—â—É": 8},
        "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ —Ä–µ–∫–ª–∞–º—É": 0, "–ù–∞–ª–æ–≥ –Ω–∞ —Å–æ—Ü—Å–µ—Ç–∏": 2, "–ù–∞–ª–æ–≥ –Ω–∞ –ø—É—Å—Ç—É—é—â–µ–µ –∂–∏–ª—å—ë": 5, "–ù–∞–ª–æ–≥ –Ω–∞ —Å–ø–µ–∫—É–ª—è—Ü–∏—é –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é": 8}
    },
    "–§—Ä–∞–Ω—Ü–∏—è": {
        "–¢—É—Ä–∏–∑–º": {"–ù–∞–ª–æ–≥ –Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª–∏—Ü": 0, "–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –∑–∞ –º—É–∑–µ–∏": 2, "–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–µ –≤ –æ—Ç–µ–ª—è—Ö": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –∞–≤–∏–∞–ø–µ—Ä–µ–ª—ë—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω—ã": 8},
        "–≠–∫–æ–ª–æ–≥–∏—è": {"–ù–∞–ª–æ–≥ –Ω–∞ –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã": 0, "–°–±–æ—Ä –∑–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫—É –æ—Ç—Ö–æ–¥–æ–≤": 2, "–ù–∞–ª–æ–≥ –Ω–∞ –≤—ä–µ–∑–¥ –∞–≤—Ç–æ –≤ —Ü–µ–Ω—Ç—Ä": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞": 8},
        "–ú–µ–¥–∏—Ü–∏–Ω–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ —Å–ª–∞–¥–æ—Å—Ç–∏": 0, "–ù–∞–ª–æ–≥ –Ω–∞ —Å–ª–∞–¥–∫–∏–µ –Ω–∞–ø–∏—Ç–∫–∏": 2, "–°–±–æ—Ä –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –≤—Ä–µ–¥–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã": 8},
        "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ –º–æ–¥–Ω—É—é –æ–¥–µ–∂–¥—É": 0, "–°–±–æ—Ä –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è": 2, "–ù–∞–ª–æ–≥ –Ω–∞ –±–∏–∑–Ω–µ—Å –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –ø—É—Å—Ç—É—é—â–µ–µ –∂–∏–ª—å—ë": 8}
    },
    "–ö–∏—Ç–∞–π": {
        "–¢—É—Ä–∏–∑–º": {"–ù–∞–ª–æ–≥ –Ω–∞ —Ñ–æ—Ç–æ —Ç—É—Ä–∏—Å—Ç–æ–≤": 0, "–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä": 2, "–°–±–æ—Ä –∑–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–æ–Ω": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –º–∞—Å—Å–æ–≤—ã–µ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": 8},
        "–≠–∫–æ–ª–æ–≥–∏—è": {"–ù–∞–ª–æ–≥ –Ω–∞ —É–ø–∞–∫–æ–≤–∫—É": 0, "–°–±–æ—Ä –∑–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫—É –æ—Ç—Ö–æ–¥–æ–≤": 2, "–ù–∞–ª–æ–≥ –Ω–∞ –≤—ã–±—Ä–æ—Å—ã –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ": 8},
        "–ú–µ–¥–∏—Ü–∏–Ω–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ —Å–ª–∞–¥–æ—Å—Ç–∏": 0, "–ù–∞–ª–æ–≥ –Ω–∞ —Å–ª–∞–¥–∫–∏–µ –Ω–∞–ø–∏—Ç–∫–∏": 2, "–°–±–æ—Ä –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –≤—Ä–µ–¥–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏": 8},
        "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞": {"–ù–∞–ª–æ–≥ –Ω–∞ –Ω–æ—á–Ω—ã–µ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è": 0, "–°–±–æ—Ä –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –≤ –≥–æ—Ä–æ–¥–µ": 2, "–°–±–æ—Ä –∑–∞ –ø–µ—Ä–µ–Ω–∞—Å–µ–ª—ë–Ω–Ω–æ—Å—Ç—å –º–µ–≥–∞–ø–æ–ª–∏—Å–∞": 5, "–ù–∞–ª–æ–≥ –Ω–∞ –ø–µ—Ä–µ–≥—Ä—É–∑ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã": 8}
    }
}

bonus_codes = ["LIT2S9KGJH9", "LIT2Sbmkjh", "CLASSIC35vx52p", "promokodi30j", "PROKACHAYSYA"]

# –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
def countries_keyboard():
    kb = ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("–ò—Ç–∞–ª–∏—è", "–Ø–ø–æ–Ω–∏—è")
    kb.add("–°–®–ê", "–§—Ä–∞–Ω—Ü–∏—è", "–ö–∏—Ç–∞–π")
    kb.add("üìä –ú–æ–∏ –±–∞–ª–ª—ã")
    return kb

def sectors_keyboard():
    kb = ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("–¢—É—Ä–∏–∑–º", "–≠–∫–æ–ª–æ–≥–∏—è")
    kb.add("–ú–µ–¥–∏—Ü–∏–Ω–∞", "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞")
    kb.add("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å—Ç—Ä–∞–Ω–∞–º")
    return kb

def taxes_keyboard(country, sector):
    kb = ReplyKeyboardMarkup(resize_keyboard=True)
    taxes = list(tax_data[country][sector].keys())
    random.shuffle(taxes)
    kb.add(taxes[0], taxes[1])
    kb.add(taxes[2], taxes[3])
    kb.add("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å—Ñ–µ—Ä–∞–º")
    return kb

# –•—ç–Ω–¥–ª–µ—Ä—ã
@router.message(Command("start"))
async def start(message: types.Message):
    uid = message.from_user.id
    user_scores[uid] = 0
    user_state[uid] = {}
    await message.answer("üåç –ò–≥—Ä–∞ ¬´–ù–µ–æ–±—ã—á–Ω—ã–µ –Ω–∞–ª–æ–≥–∏ –º–∏—Ä–∞¬ª!\n–í—ã–±–∏—Ä–∞–π —Å—Ç—Ä–∞–Ω—É ‚Üí —Å—Ñ–µ—Ä—É ‚Üí –Ω–∞–ª–æ–≥.\nüéÅ 50 –±–∞–ª–ª–æ–≤ = –±–æ–Ω—É—Å—ã!", reply_markup=countries_keyboard())

@router.message(Text("üìä –ú–æ–∏ –±–∞–ª–ª—ã"))
async def my_score(message: types.Message):
    uid = message.from_user.id
    await message.answer(f"üìä –í–∞—à–∏ –±–∞–ª–ª—ã: {user_scores.get(uid, 0)}", reply_markup=countries_keyboard())

@router.message(Text(list(tax_data.keys())))
async def choose_sector(message: types.Message):
    uid = message.from_user.id
    user_state[uid] = {"country": message.text}
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ñ–µ—Ä—É:", reply_markup=sectors_keyboard())

@router.message(Text("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å—Ç—Ä–∞–Ω–∞–º"))
async def back_to_countries(message: types.Message):
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É:", reply_markup=countries_keyboard())

@router.message(Text(["–¢—É—Ä–∏–∑–º", "–≠–∫–æ–ª–æ–≥–∏—è", "–ú–µ–¥–∏—Ü–∏–Ω–∞", "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞"]))
async def choose_tax(message: types.Message):
    uid = message.from_user.id
    if uid not in user_state or "country" not in user_state[uid]:
        await message.answer("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É.", reply_markup=countries_keyboard())
        return
    user_state[uid]["sector"] = message.text
    country = user_state[uid]["country"]
    sector = user_state[uid]["sector"]
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ª–æ–≥:", reply_markup=taxes_keyboard(country, sector))

@router.message(Text("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å—Ñ–µ—Ä–∞–º"))
async def back_to_sectors(message: types.Message):
    uid = message.from_user.id
    if uid not in user_state or "country" not in user_state[uid]:
        await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É:", reply_markup=countries_keyboard())
        return
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ñ–µ—Ä—É:", reply_markup=sectors_keyboard())

@router.message()
async def handle_tax(message: types.Message):
    uid = message.from_user.id
    if uid not in user_state or "country" not in user_state[uid] or "sector" not in user_state[uid]:
        await message.answer("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É –∏ —Å—Ñ–µ—Ä—É.", reply_markup=countries_keyboard())
        return
    country = user_state[uid]["country"]
    sector = user_state[uid]["sector"]

    if message.text not in tax_data[country][sector]:
        await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ª–æ–≥ —Å –∫–Ω–æ–ø–æ–∫.", reply_markup=taxes_keyboard(country, sector))
        return

    points = tax_data[country][sector][message.text]
    user_scores[uid] += points
    remaining = max(0, 50 - user_scores[uid])

    text = f"‚úÖ –í—ã –≤—ã–±—Ä–∞–ª–∏:\n{message.text}\n\nüéØ –ë–∞–ª–ª—ã –∑–∞ —ç—Ç–æ—Ç –Ω–∞–ª–æ–≥: {points}\nüìä –í—Å–µ–≥–æ –±–∞–ª–ª–æ–≤: {user_scores[uid]}\n‚è≥ –û—Å—Ç–∞–ª–æ—Å—å –¥–æ –±–æ–Ω—É—Å–∞: {remaining}"

    if user_scores[uid] >= 50:
        text += "\n\nüéÅ –ë–æ–Ω—É—Å—ã –æ—Ç–∫—Ä—ã—Ç—ã:\n" + "\n".join(bonus_codes)

    await message.answer(text, reply_markup=countries_keyboard())

dp.include_router(router)

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
